From 83b27022464a123bab4f57f4891962788452f143 Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Fri, 15 Jan 2016 15:41:46 -0600
Subject: [PATCH 2/4] fix sleep43xx.S: for thumb2

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/mach-omap2/sleep43xx.S | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/arch/arm/mach-omap2/sleep43xx.S b/arch/arm/mach-omap2/sleep43xx.S
index 28b6e03..512df3b 100644
--- a/arch/arm/mach-omap2/sleep43xx.S
+++ b/arch/arm/mach-omap2/sleep43xx.S
@@ -72,7 +72,9 @@ ENTRY(am43xx_do_wfi)
 	/* Retrieve l2 cache virt address BEFORE we shut off EMIF */
 	ldr	r1, get_l2cache_base
 	blx	r1
-	str	r0, l2_base_virt
+ARM(	str	r0, l2_base_virt )
+THUMB(	adr	r1, l2_base_virt )
+THUMB(	str	r0, [r1] )
 
 	/*
 	 * Flush all data from the L1 and L2 data cache before disabling
-- 
2.7.0

