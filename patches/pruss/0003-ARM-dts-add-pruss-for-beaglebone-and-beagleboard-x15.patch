From d296bccb085980822272d7b7367205714d3b6682 Mon Sep 17 00:00:00 2001
From: Matthijs van Duin <matthijsvanduin@gmail.com>
Date: Sat, 9 Feb 2019 20:57:38 +0100
Subject: [PATCH] ARM: dts: add pruss for beaglebone and beagleboard-x15

---
 .../dts/am335x-bone-common-no-capemgr.dtsi    |  8 +++
 arch/arm/boot/dts/am335x-bone-common.dtsi     |  8 +++
 arch/arm/boot/dts/am33xx.dtsi                 | 23 ++++++++
 .../boot/dts/am57xx-beagle-x15-common.dtsi    | 16 +++++
 arch/arm/boot/dts/dra7.dtsi                   | 58 +++++++++++++++++++
 5 files changed, 113 insertions(+)

diff --git a/arch/arm/boot/dts/am335x-bone-common-no-capemgr.dtsi b/arch/arm/boot/dts/am335x-bone-common-no-capemgr.dtsi
index 26c850680a9b..3a82af61a0ef 100644
--- a/arch/arm/boot/dts/am335x-bone-common-no-capemgr.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-common-no-capemgr.dtsi
@@ -377,3 +377,11 @@
 &wkup_m3_ipc {
 	ti,scale-data-fw = "am335x-bone-scale-data.bin";
 };
+
+&pruss_soc_bus {
+	status = "okay";
+};
+
+&pruss {
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/am335x-bone-common.dtsi b/arch/arm/boot/dts/am335x-bone-common.dtsi
index 1346cdb7cda9..be007283bcc8 100644
--- a/arch/arm/boot/dts/am335x-bone-common.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-common.dtsi
@@ -464,6 +464,14 @@
 	ti,scale-data-fw = "am335x-bone-scale-data.bin";
 };
 
+&pruss_soc_bus {
+	status = "okay";
+};
+
+&pruss {
+	status = "okay";
+};
+
 &ocp {
 	/* P9_19 (ZCZ ball D17) i2c */
 	P9_19_pinmux {
diff --git a/arch/arm/boot/dts/am33xx.dtsi b/arch/arm/boot/dts/am33xx.dtsi
index 4690ac4fbe4f..4291db3ca670 100644
--- a/arch/arm/boot/dts/am33xx.dtsi
+++ b/arch/arm/boot/dts/am33xx.dtsi
@@ -719,6 +719,29 @@
 			ti,timer-pwm;
 		};
 
+		pruss_soc_bus: pruss_soc_bus@4a326004 {
+			compatible = "ti,am3356-pruss-soc-bus", "simple-pm-bus";
+			reg = <0x4a326004 0x4>;
+			ti,hwmods = "pruss";
+			ti,deassert-hard-reset = "pruss", "pruss";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			ranges = <0x0 0x4a300000 0x80000>;
+			status = "disabled";
+
+			pruss: pruss@0 {
+				compatible = "ti,pruss-v2";
+				reg = <0 0x80000>;
+				interrupt-parent = <&intc>;
+				interrupts = <20 21 22 23 24 25 26 27>;
+				interrupt-names = "host2", "host3", "host4",
+				                  "host5", "host6", "host7",
+				                  "host8", "host9";
+				ti,pintc-offset = <0x20000>;
+				status = "disabled";
+			};
+		};
+
 		rtc: rtc@44e3e000 {
 			compatible = "ti,am3352-rtc", "ti,da830-rtc";
 			reg = <0x44e3e000 0x1000>;
diff --git a/arch/arm/boot/dts/am57xx-beagle-x15-common.dtsi b/arch/arm/boot/dts/am57xx-beagle-x15-common.dtsi
index ba63dc2c6de2..65ff98e53fa0 100644
--- a/arch/arm/boot/dts/am57xx-beagle-x15-common.dtsi
+++ b/arch/arm/boot/dts/am57xx-beagle-x15-common.dtsi
@@ -595,3 +595,19 @@
 		status = "okay";
 	};
 };
+
+&pruss_soc_bus1 {
+	status = "okay";
+};
+
+&pruss1 {
+	status = "okay";
+};
+
+&pruss_soc_bus2 {
+	status = "okay";
+};
+
+&pruss2 {
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/dra7.dtsi b/arch/arm/boot/dts/dra7.dtsi
index 8a4d1d1077ae..ad7ded4a5d08 100644
--- a/arch/arm/boot/dts/dra7.dtsi
+++ b/arch/arm/boot/dts/dra7.dtsi
@@ -1184,6 +1184,64 @@
 			status = "disabled";
 		};
 
+		pruss_soc_bus1: pruss_soc_bus@4b226004 {
+			compatible = "ti,am5728-pruss-soc-bus", "simple-pm-bus";
+			reg = <0x4b226004 0x4>;
+			ti,hwmods = "pruss1";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			ranges = <0x0 0x4b200000 0x80000>;
+			status = "disabled";
+
+			pruss1: pruss@0 {
+				compatible = "ti,pruss-v2";
+				reg = <0 0x80000>;
+				pruss-instance = "pruss1";
+				interrupts = <GIC_SPI 186 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 187 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 188 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 189 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 190 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 191 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 192 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 193 IRQ_TYPE_LEVEL_HIGH>;
+				interrupt-names = "host2", "host3", "host4",
+				                  "host5", "host6", "host7",
+				                  "host8", "host9";
+				ti,pintc-offset = <0x20000>;
+				status = "disabled";
+			};
+		};
+
+		pruss_soc_bus2: pruss_soc_bus@4b2a6004 {
+			compatible = "ti,am5728-pruss-soc-bus", "simple-pm-bus";
+			reg = <0x4b2a6004 0x4>;
+			ti,hwmods = "pruss2";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			ranges = <0x0 0x4b280000 0x80000>;
+			status = "disabled";
+
+			pruss2: pruss@0 {
+				compatible = "ti,pruss-v2";
+				reg = <0 0x80000>;
+				pruss-instance = "pruss2";
+				interrupts = <GIC_SPI 196 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 197 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 198 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 199 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 200 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 201 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 202 IRQ_TYPE_LEVEL_HIGH>,
+				             <GIC_SPI 203 IRQ_TYPE_LEVEL_HIGH>;
+				interrupt-names = "host2", "host3", "host4",
+				                  "host5", "host6", "host7",
+				                  "host8", "host9";
+				ti,pintc-offset = <0x20000>;
+				status = "disabled";
+			};
+		};
+
 		abb_mpu: regulator-abb-mpu {
 			compatible = "ti,abb-v3";
 			regulator-name = "abb_mpu";
-- 
2.20.1

