From bc861abf311ee91b634772384557a773bc420e4f Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Thu, 3 Mar 2016 16:33:13 -0600
Subject: [PATCH 3/3] bbgw: switch from gpio-hog back to regulator-gpio for
 wl_en

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/boot/dts/am335x-bonegreen-wl1835.dtsi | 33 ++++++++++----------------
 1 file changed, 12 insertions(+), 21 deletions(-)

diff --git a/arch/arm/boot/dts/am335x-bonegreen-wl1835.dtsi b/arch/arm/boot/dts/am335x-bonegreen-wl1835.dtsi
index 9557dc3..ac0e807 100644
--- a/arch/arm/boot/dts/am335x-bonegreen-wl1835.dtsi
+++ b/arch/arm/boot/dts/am335x-bonegreen-wl1835.dtsi
@@ -9,19 +9,20 @@
 		regulator-max-microvolt = <1800000>;
 
 		/* WL_EN */
-		//gpio = <&gpio0 26 1>;
-		//enable-active-high;
+		gpio = <&gpio0 26 0>;
+		enable-active-high;
 	};
 
 	tibt {
-	        compatible = "tibt";
-	        nshutdown_gpio = <60>;
-	        dev_name = "/dev/ttyO3";
-	        flow_cntrl = <1>;
-	        baud_rate = <3000000>;
+		compatible = "tibt";
+		nshutdown_gpio = <60>;
+		dev_name = "/dev/ttyO3";
+		flow_cntrl = <1>;
+		baud_rate = <3000000>;
 	};
+
 	btwilink {
-	        compatible = "btwilink";
+		compatible = "btwilink";
 	};
 };
 
@@ -94,11 +95,10 @@
 
 &mmc3 {
 	dmas = <&edma 12
-			&edma 13>;
+		&edma 13>;
 	dma-names = "tx", "rx";
 	status = "okay";
-	//vmmc-supply = <&wlan_en_reg>;
-	vmmc-supply = <&vmmcsd_fixed>;
+	vmmc-supply = <&wlan_en_reg>;
 	bus-width = <4>;
 	pinctrl-names = "default", "sleep";
 	pinctrl-0 = <&mmc3_pins &wlan_pins>;
@@ -117,20 +117,11 @@
 		interrupts = <27 IRQ_TYPE_LEVEL_HIGH>;
 	};
 };
+
 &edma {
 	ti,edma-xbar-event-map = /bits/ 16 <1 12 2 13>;
 };
 
-&gpio0 {
-	wl_en {
-		gpio-hog;
-		gpios = <26 GPIO_ACTIVE_HIGH>;
-		output-high;
-		line-name = "WL_EN";
-	};
-};
-
-
 &uart3 {
 	pinctrl-names = "default", "sleep";
 	pinctrl-0 = <&uart3_pins_default>;
-- 
2.7.0

