From c6d0d7fdf7ce90b562004af5c7ba1512d4a5e5dd Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Tue, 16 Sep 2014 11:11:22 -0500
Subject: [PATCH 21/21] lcd7: fix pinmux collusions

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi |  6 ++++++
 arch/arm/boot/dts/am335x-bone-keymap0.dtsi       | 18 ++++++++++++++++++
 arch/arm/boot/dts/am335x-bone-panel-800x480.dtsi |  8 +++++++-
 3 files changed, 31 insertions(+), 1 deletion(-)

diff --git a/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi b/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
index 4f7ff30..4a5a3b0 100644
--- a/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-common-pinmux.dtsi
@@ -226,6 +226,12 @@
 		>;
 	};
 
+	bbcape_lcd7_avdd_en_pins: bbcape_lcd7_avdd_en {
+		pinctrl-single,pins = <
+			0x150 (PIN_OUTPUT_PULLUP | MUX_MODE7)	/* spi0_sclk.gpio0_2, OUTPUT | MODE7 - AVDD_EN */
+		>;
+	};
+
 	bbcape_lcd4_disen_pins: bbcape_lcd4_disen_pins {
 		pinctrl-single,pins = <
 			0x1a4 (PIN_OUTPUT_PULLUP | MUX_MODE7)	/* mcasp0_fsr.gpio3[19] (lcd_disen) */
diff --git a/arch/arm/boot/dts/am335x-bone-keymap0.dtsi b/arch/arm/boot/dts/am335x-bone-keymap0.dtsi
index 4bfde0c..5a510fb 100644
--- a/arch/arm/boot/dts/am335x-bone-keymap0.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-keymap0.dtsi
@@ -6,6 +6,24 @@
  * published by the Free Software Foundation.
  */
 
+&ocp {
+	P9_15_pinmux {
+		status = "disabled";
+	};
+	P9_16_pinmux {
+		status = "disabled";
+	};
+	P9_21_pinmux {
+		status = "disabled";
+	};
+	P9_23_pinmux {
+		status = "disabled";
+	};
+	P9_30_pinmux {
+		status = "disabled";
+	};
+};
+
 / {
 	gpio_keys {
 		compatible = "gpio-keys";
diff --git a/arch/arm/boot/dts/am335x-bone-panel-800x480.dtsi b/arch/arm/boot/dts/am335x-bone-panel-800x480.dtsi
index cbc5e66..6666295 100644
--- a/arch/arm/boot/dts/am335x-bone-panel-800x480.dtsi
+++ b/arch/arm/boot/dts/am335x-bone-panel-800x480.dtsi
@@ -6,6 +6,12 @@
  * published by the Free Software Foundation.
  */
 
+&ocp {
+	P9_22_pinmux {
+		status = "disabled";
+	};
+};
+
 &lcdc {
 	status = "okay";
 };
@@ -15,7 +21,7 @@
 		status = "okay";
 		compatible = "ti,tilcdc,panel";
 		pinctrl-names = "default";
-		pinctrl-0 = <&bbcape_lcd_pins>;
+		pinctrl-0 = <&bbcape_lcd_pins &bbcape_lcd7_avdd_en_pins>;
 		panel-info {
 			ac-bias           = <255>;
 			ac-bias-intrpt    = <0>;
-- 
2.1.0

