From bd95db6e83de109ac2409c682f00d552b6045050 Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Mon, 29 Sep 2014 13:34:59 -0500
Subject: [PATCH 04/20] am335x-boneblack: split out nxp hdmi audio

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 .../boot/dts/am335x-boneblack-nxp-hdmi-audio.dtsi  | 65 ++++++++++++++++++++++
 arch/arm/boot/dts/am335x-boneblack.dts             | 60 +-------------------
 2 files changed, 67 insertions(+), 58 deletions(-)
 create mode 100644 arch/arm/boot/dts/am335x-boneblack-nxp-hdmi-audio.dtsi

diff --git a/arch/arm/boot/dts/am335x-boneblack-nxp-hdmi-audio.dtsi b/arch/arm/boot/dts/am335x-boneblack-nxp-hdmi-audio.dtsi
new file mode 100644
index 0000000..73baff2
--- /dev/null
+++ b/arch/arm/boot/dts/am335x-boneblack-nxp-hdmi-audio.dtsi
@@ -0,0 +1,65 @@
+/*
+ * Copyright (C) 2012 Texas Instruments Incorporated - http://www.ti.com/
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+&lcdc {
+	status = "okay";
+};
+
+&mcasp0	{
+	pinctrl-names = "default", "sleep";
+	pinctrl-0 = <&mcasp0_pins>;
+	pinctrl-1 = <&mcasp0_pins_sleep>;
+	status = "okay";
+	op-mode = <0>;	/* MCASP_IIS_MODE */
+	tdm-slots = <2>;
+	serial-dir = <	/* 0: INACTIVE, 1: TX, 2: RX */
+			0 0 1 0
+		>;
+	tx-num-evt = <1>;
+	rx-num-evt = <1>;
+};
+
+/ {
+	hdmi {
+		compatible = "ti,tilcdc,slave";
+		i2c = <&i2c0>;
+		pinctrl-names = "default", "off";
+		pinctrl-0 = <&nxp_hdmi_bonelt_pins>;
+		pinctrl-1 = <&nxp_hdmi_bonelt_off_pins>;
+		status = "okay";
+	};
+
+	clk_mcasp0_fixed: clk_mcasp0_fixed {
+	      #clock-cells = <0>;
+	      compatible = "fixed-clock";
+	      clock-frequency = <24576000>;
+	};
+
+	clk_mcasp0: clk_mcasp0 {
+	      #clock-cells = <0>;
+	      compatible = "ti,gpio-gate-clock";
+	      clocks = <&clk_mcasp0_fixed>;
+	      enable-gpios = <&gpio1 27 0>; /* BeagleBone Black Clk enable on GPIO1_27 */
+	};
+
+	hdmi_audio: hdmi_audio@0 {
+	       compatible = "linux,hdmi-audio";
+	       status = "okay";
+	};
+
+	sound {
+		compatible = "ti,beaglebone-black-audio";
+		ti,model = "TI BeagleBone Black";
+		ti,audio-codec = <&hdmi_audio>;
+		ti,mcasp-controller = <&mcasp0>;
+		ti,audio-routing =
+			"HDMI Out",	"TX";
+		clocks = <&clk_mcasp0>;
+		clock-names = "mclk";
+	};
+};
diff --git a/arch/arm/boot/dts/am335x-boneblack.dts b/arch/arm/boot/dts/am335x-boneblack.dts
index cac4664..46f3e8a 100644
--- a/arch/arm/boot/dts/am335x-boneblack.dts
+++ b/arch/arm/boot/dts/am335x-boneblack.dts
@@ -27,61 +27,5 @@
 };
 
 #include "am335x-boneblack-emmc.dtsi"
-
-&lcdc {
-	status = "okay";
-};
-
-&mcasp0	{
-	pinctrl-names = "default", "sleep";
-	pinctrl-0 = <&mcasp0_pins>;
-	pinctrl-1 = <&mcasp0_pins_sleep>;
-	status = "okay";
-	op-mode = <0>;	/* MCASP_IIS_MODE */
-	tdm-slots = <2>;
-	serial-dir = <	/* 0: INACTIVE, 1: TX, 2: RX */
-			0 0 1 0
-		>;
-	tx-num-evt = <1>;
-	rx-num-evt = <1>;
-};
-
-/ {
-	hdmi {
-		compatible = "ti,tilcdc,slave";
-		i2c = <&i2c0>;
-		pinctrl-names = "default", "off";
-		pinctrl-0 = <&nxp_hdmi_bonelt_pins>;
-		pinctrl-1 = <&nxp_hdmi_bonelt_off_pins>;
-		status = "okay";
-	};
-
-	clk_mcasp0_fixed: clk_mcasp0_fixed {
-	      #clock-cells = <0>;
-	      compatible = "fixed-clock";
-	      clock-frequency = <24576000>;
-	};
-
-	clk_mcasp0: clk_mcasp0 {
-	      #clock-cells = <0>;
-	      compatible = "ti,gpio-gate-clock";
-	      clocks = <&clk_mcasp0_fixed>;
-	      enable-gpios = <&gpio1 27 0>; /* BeagleBone Black Clk enable on GPIO1_27 */
-	};
-
-	hdmi_audio: hdmi_audio@0 {
-	       compatible = "linux,hdmi-audio";
-	       status = "okay";
-	};
-
-	sound {
-		compatible = "ti,beaglebone-black-audio";
-		ti,model = "TI BeagleBone Black";
-		ti,audio-codec = <&hdmi_audio>;
-		ti,mcasp-controller = <&mcasp0>;
-		ti,audio-routing =
-			"HDMI Out",	"TX";
-		clocks = <&clk_mcasp0>;
-		clock-names = "mclk";
-	};
-};
+/* HDMI: with audio */
+#include "am335x-boneblack-nxp-hdmi-audio.dtsi"
-- 
2.1.0

